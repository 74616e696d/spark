import { Meta } from '@storybook/blocks'
import { StoryHeading } from '@docs/helpers/StoryHeading'
import { Alert } from '@docs/helpers/Alert'

<Meta title="Getting Started" />

<StoryHeading label="Getting started" as="h1" />

<Alert marginBottom="medium">
  **The Spark Design System** is built using the **Tailwind CSS** framework.
</Alert>

<StoryHeading label="Set up TailwindCSS" as="h2" />

If you haven't installed **TailwindCSS** yet, you can follow the [TailwindCSS installation guide](https://tailwindcss.com/docs/installation).

To benefit from Tailwind CSS **IntelliSense**, be sure to visit this [link](https://tailwindcss.com/docs/editor-setup#intelli-sense-for-vs-code)

<Alert kind="warning" marginBottom="medium">
  You can omit the part where you **Add the Tailwind directives to your CSS**, as our cli command
  will generate this file for you.
</Alert>

<StoryHeading label="Installation" as="h2" />

Install the following Spark packages via your command line.

```bash
npm i @spark-ui/theme-utils @spark-ui/cli-utils
```

<StoryHeading label="‚ú® Creating your spark.theme.config file" as="h2" />

To properly configure your project, please create a file called `spark.theme.config` at the root of your project. You can use either the `.ts` or `.js` file extension.

Within this file, you will be abe to define your project's themes, as well as the paths for the Tailwind theme config file and CSS file, which will be generated by **our CLI command.**

This file should export a **default** object adhering to the `ThemeConfig` interface.

**ThemeConfig:**

```ts
interface ThemeConfig {
  tailwindThemeConfigPath: string
  tailwindCSSPath: string
  themes: RequireAtLeastOne<Record<string, Theme>, 'default'>
}
```

**tailwindThemeConfigPath**:

This field specifies the path where our CLI command will generate a `.js` file. This file will contain an object that tells Tailwind how to retrieve values from our Spark theme structure

**tailwindCSSFilePath**:

This field specifies the path where our CLI command will generate a `.css` file. This file will contain the **Tailwind CSS directives** + the different classes containing every token defined in your theme. Each class will correspond to a key in the `themes` object.

**themes**:

An object containing your themes. Each key in the object will be extracted to a class name, and the values will be converted to CSS custom properties inside the `.css` generated file. **Note that this object requires a key with a value of default**, which specifies the default theme for your project.

For example, if your themes object looks like this:

```ts
const themes = {
  default: defaultTheme,
  foo: barTheme,
}
```

You will get the following CSS classes in the generated `.css` file:

```css
:root {
  /* ...tokens from defaultTheme */
}

.foo {
  /* ...tokens from barTheme */
}
```

Now, let's get back to our `spark.config` file. Check out the example below to see how a properly structured config file should look.

```tsx
// spark.theme.config.ts
import { createTheme, Theme, ThemeConfig } from '@spark-ui/theme-utils'

const defaultTheme: Theme = createTheme({ ... })
const darkTheme: Theme = createTheme({ ... })

const themes = {
  default: defaultTheme,
  dark: darkTheme,
}

export default {
  tailwindThemeConfigPath: './tailwind.theme.js',
  tailwindCSSFilePath: './src/tailwind.css',
  themes
} satisfies ThemeConfig
```

<StoryHeading label="CLI command" as="h2" />

When you're ready and run our CLI command:

```bash
npx spark setup-themes
```

The following will happen:

1Ô∏è‚É£ `tailwind.theme.js` will be generated (according to the path specified inside `spark.theme.config`)

```js
// ./tailwind.theme.js
module.exports = {
  ...,
  spacing: {
    ...,
    s: 'var(--spacing-s)',
    m: 'var(--spacing-m)',
    ...,
  }
  ...
}
```

2Ô∏è‚É£ `tailwind.css` will be generated (according to the path + themes object specified inside `spark.theme.config`)

```css
// ./src/tailwind.css

@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    --spacing-s: 0.8rem;
    --spacing-m: 1.6rem;
    ...;
  }

  .dark {
    --spacing-s: 0.8rem;
    --spacing-m: 1.6rem;
    ...;
  }
}
```

<StoryHeading label="Final steps" as="h2" />

You're almost done! There are just two more steps left:

- Open your **Tailwind configuration file** (usually `tailwind.config.js`) and update it as follows:

```js
const themeConf = require('./tailwind.theme.js') // ‚¨ÖÔ∏è import our generated file

/** @type {import('tailwindcss').Config} */

module.exports = {
  theme: themeConf // ‚¨ÖÔ∏è overriding tailwind default theme with our own
  },
  content: ['./node_modules/@spark-ui/**/*.{js,mjs}', ...], // ‚¨ÖÔ∏è ensure that the Spark components are scanned
}
```

<Alert>
  If you need to address any rare scenarios, know that you can override our theme configuration, as
  demonstrated in the example below ‚¨áÔ∏è
</Alert>

```js
const themeConf = require('./tailwind.theme.js')

/** @type {import('tailwindcss').Config} */

module.exports = {
  theme: {
    ...themeConf,
    screens: {
      ...themeConf.screens,
      customScreen: '218px' ... // ‚¨ÖÔ∏è overriding / extending our Spark theme configuration
    }
  },
  content: ['./node_modules/@spark-ui/**/*.{js,mjs}', ...],
}
```

- Then, inside a file in your application where you import your global styles, import our generated `.css` file. If you are using **Next.js**, that would be `_app.tsx`

```tsx
// some file in your application where you can import global styles

import '../tailwind.css' // ‚¨ÖÔ∏è our generated file
```

- That's all there is to it! üéâ

Just remember to run our **CLI command** every time you update your themes to avoid going out of sync. We recommend running the command before you run your dev script, like so:

```json
// package.json

"scripts": {
  "start": "npx spark setup-theme && npm run your-main-script"
}
```
